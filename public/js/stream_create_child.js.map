{"version":3,"sources":["stream_create_child.js"],"names":[],"mappings":";;AAAA,QAAQ,CACJ,UADI,EAEJ,UAFI,EAGJ,kBAHI,EAIJ,qBAJI,CAAR,EAKA,UACI,MADJ,EAEI,MAFJ,EAGI,cAHJ,EAII,iBAJJ,EAKA;AACA,iBADA;;AAGA,QAAI,eAAe,SAAf,YAAe,CAAS,IAAT,EAAe,MAAf,EAAuB;AACtC,YAAI,OAAO,IAAP,CADkC;AAEtC,0BAAkB,YAAlB,CAA+B,IAA/B,CAAoC,IAApC,EAA0C,IAA1C,EAFsC;KAAvB,CAHnB;;AAQA,QAAI,YAAY,SAAZ,SAAY,GAAW;AACvB,YAAI,OAAO,mBAAmB,OAAO,QAAP,CAAgB,QAAhB,CAAnB,CAA6C,KAA7C,CAAmD,SAAnD,CAAP,CADmB;AAEvB,eAAQ,IAAC,IAAQ,KAAK,CAAL,CAAR,IAAoB,EAArB,CAFe;KAAX,CARhB;;AAaA,MAAE,YAAU;AACR,YAAI,QAAQ,IAAI,YAAJ,CACR,kBAAkB,WAAlB,EADQ,CAAR,CADI;;AAIR,UAAE,sBAAF,EAA0B,KAA1B,CAAgC,UAAS,CAAT,EAAY;AACxC,gBAAI,MAAM,EAAE,IAAF,CAAN,CADoC;AAExC,mBAAO,UAAP,CAAkB,GAAlB,EAFwC;;AAIxC,gBAAI,SAAS,WAAT,CAJoC;AAKxC,gBAAI,cAAc,OAAO,WAAP,CAAmB,GAAnB,CAAd,CALoC;AAMxC,gBAAI,SAAS,OAAO,KAAP,CAAa,CAAb,EAAgB,WAAhB,CAAT,CANoC;AAOxC,gBAAI,OAAO,OAAO,KAAP,CAAa,cAAc,CAAd,CAAb,CAA8B,IAA9B,EAAP,CAPoC;AAQxC,gBAAI,MAAM,SAAS,GAAT,GAAe,IAAf,CAR8B;AASxC,cAAE,IAAF,CAAO;AACH,sBAAM,KAAN;AACA,qBAAK,SAAS,WAAT,CAAqB,mBAArB,CAAyC,eAAzC,GAA2D,GAA3D;AACL,6BAAa,kBAAb;AACA,sBAAM,KAAK,SAAL,CAAe;AACnB,0BAAM,IAAN;AACA,yBAAK,GAAL;iBAFI,CAAN;AAIA,uBAAO,eAAS,CAAT,EAAY;AACf,2BAAO,YAAP,CAAoB,GAApB,EADe;iBAAZ;aARX,EAYC,IAZD,CAYM,UAAS,MAAT,EAAiB;AACnB,oBAAI,UAAU,CAAC,OAAO,KAAP,EAAc;AACzB,6BAAS,QAAT,CAAkB,IAAlB,GAAyB,SAAS,WAAT,CAAqB,MAArB,CAA4B,SAA5B,CAAsC,OAAO,GAAP,CAAtC,CAAkD,GAAlD,CADA;iBAA7B,MAEO;AACH,2BAAO,YAAP,CAAoB,GAApB,EADG;iBAFP;aADE,CAZN,CATwC;SAAZ,CAAhC,CAJQ;;AAkCR,WAAG,aAAH,CAAiB,KAAjB,EAlCQ;KAAV,CAAF,CAbA;CALA,CALA","file":"stream_create_child.js","sourcesContent":["require([\n    './models',\n    './shared',\n    './stream_manager',\n    './application_model'],\nfunction(\n    models,\n    shared,\n    stream_manager,\n    application_model)\n{\n\"use-strict\";\n\nvar AppViewModel = function(user, stream) {\n    var self = this;\n    application_model.AppViewModel.call(this, user);\n};\n\nvar getTarget = function() {\n    var path = decodeURIComponent(window.location.pathname).match('/s/(.+)');\n    return ((path && path[1]) || '');\n};\n\n$(function(){\n    var model = new AppViewModel(\n        application_model.initialUser());\n\n    $('.create-child-button').click(function(e) {\n        var btn = $(this);\n        shared.lockButton(btn);\n\n        var rawUri = getTarget();\n        var parentIndex = rawUri.lastIndexOf('/');\n        var parent = rawUri.slice(0, parentIndex);\n        var name = rawUri.slice(parentIndex + 1).trim();\n        var uri = parent + \"/\" + name;\n        $.ajax({\n            type: \"PUT\",\n            url: jsRoutes.controllers.StreamApiController.apiCreateStream().url,\n            contentType: 'application/json',\n            data: JSON.stringify({\n              name: name,\n              uri: uri\n            }),\n            error: function(e) {\n                shared.unlockButton(btn);\n            }\n        })\n        .then(function(result) {\n            if (result && !result.error) {\n                document.location.href = jsRoutes.controllers.Stream.getStream(result.uri).url;\n            } else {\n                shared.unlockButton(btn);\n            }\n        });\n    });\n\n    ko.applyBindings(model);\n});\n\n});"],"sourceRoot":"/source/"}