{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["require([\n    './models',\n    './stream_manager',\n    './application_model',\n    './shared'],\nfunction(\n    models,\n    stream_manager,\n    application_model,\n    shared)\n{\n\"use-strict\";\n\nvar FavoriteStatus = Object.freeze({\n    Unknown: 0,\n    No: 1,\n    Yes: 2,\n    Hierarchical: 3\n});\n\nvar isHierarchical = function(parentName, uri) {\n    parentName = models.normalizeUri(parentName);\n    if (parentName === uri)\n        return true;\n\n    var index = uri.lastIndexOf('/');\n    return (index >= 0 && parentName === uri.slice(0, index));\n};\n\nvar isRootStream = function(uri) {\n    return (uri.indexOf('/') === -1);\n};\n\n/**\n*/\nvar AppViewModel = function(user, stream) {\n    var self = this;\n    application_model.AppViewModel.call(this, user);\n\n    self.stream = ko.observable(stream);\n    self.children = ko.observable(new models.Collection(stream.uri()));\n    self.query = ko.observable();\n    self.favorite = ko.observable(FavoriteStatus.Unknown);\n\n    self.color = ko.computed(function() {\n        var stream = self.stream();\n        return (stream ? stream.color() : models.DEFAULT_COLOR);\n    });\n\n    self.setColor = function(color) {\n        if (!self.stream())\n            self.stream(new models.StreamModel());\n        self.stream().setColor(color);\n    };\n\n    self.addChild = function(child) {\n        self.children().addChild(child);\n    };\n\n    self.removeChild = function(childUri) {\n        return self.children().children.remove(function(x) {\n             return x.uri() === childUri;\n         });\n    };\n\n    self.deleteStream = function(child) {\n        $.ajax({\n            type: \"DELETE\",\n            url: jsRoutes.controllers.StreamApiController.apiDeleteStream(child.id()).url,\n            error: function(e) {\n\n            }\n        }).then(function() {\n           self.removeChild(child.uri());\n        });\n    };\n\n    self.isParentOwner = ko.computed(function() {\n         return (!!self.stream() && stream.isOwner(self.user()));\n     });\n\n    self.removeChildButtonClick = function(child, event) {\n        if (isHierarchical(self.stream().uri(), child.uri())) {\n            bootbox.confirm({\n                title: \"Are you sure?\",\n                animate: false,\n                closeButton: false,\n                message: \"This will permanently delete this stream and all of its children.\",\n                callback: function(result) {\n                    if (result) {\n                        self.deleteStream(child);\n                    }\n                }\n            });\n        } else {\n             $.ajax({\n                type: \"DELETE\",\n                url: jsRoutes.controllers.StreamApiController.apiDeleteChild(self.stream().id(), child.id()).url,\n                error: function(e) {\n\n                }\n            }).then(function() {\n               self.removeChild(child.uri());\n            });\n        }\n    };\n\n    self.childSelected = function(child) {\n\n    };\n};\n\nAppViewModel.prototype.checkFavorite = function() {\n    var self = this;\n    if (!self.user().userName())\n        return;\n\n    // If the current stream is the user's root stream of a direct child, it cannot be favorited.\n    if (self.stream().id() === self.user().rootStream() || isHierarchical(self.user().userName(), self.stream().uri())) {\n        self.favorite(FavoriteStatus.Hierarchical);\n    } else {\n        $.ajax({\n            type: \"GET\",\n            url: jsRoutes.controllers.StreamApiController.apiGetChild(self.user().rootStream(), self.stream().id()).url,\n            error: function(e) {\n                if (e.status === 404) {\n                    self.favorite(FavoriteStatus.No);\n                }\n            }\n        }).then(function() {\n           self.favorite(FavoriteStatus.Yes);\n        });\n    }\n};\n\nvar initialStream = function() {\n    return models.StreamModel.fromJson(window.initialStreamData);\n};\n\n/**\n    Redraw the favicon for a given status.\n*/\nvar updateFavicon = function(color) {\n    var canvas = document.createElement('canvas');\n    var link = document.getElementById('favicon');\n\n    canvas.width = canvas.height = 1;\n    var ctx = canvas.getContext('2d');\n    ctx.fillStyle = color;\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    link.href = canvas.toDataURL('image/png');\n};\n\n/**\n*/\nvar enableFavoriteButton = function(existing) {\n    $('.stream-favorite')\n        .prop('disabled', false)\n        .prop('title', existing ? \"Remove Favorite\" : \"Add Favorite\");\n\n    if (existing)\n        $('.stream-favorite').addClass('active');\n    else\n        $('.stream-favorite').removeClass('active');\n\n};\n\nvar disableFavoriteButton = function() {\n    $('.stream-favorite')\n        .prop(\"disabled\", true);\n};\n\n/**\n*/\nvar hideChildForm = function() {\n    $('#create-child-name-input, #create-child-cancel-button').addClass('hidden');\n    $('#create-child-name-input input').val('');\n    $('.create-child .error')\n        .addClass('hidden')\n        .text('');\n};\n\nvar createChildStream = function(model, stream, user, name) {\n    $('.create-child .error').addClass('hidden');\n\n    $('#create-child-expand-button span')\n        .addClass('glyphicon-refresh glyphicon-refresh-animate');\n\n    $('#create-child-name-input input, #create-child-cancel-button button, #create-child-expand-button')\n        .prop('disabled', true);\n\n    var onComplete = function() {\n        $('#create-child-expand-button span')\n            .removeClass('glyphicon-refresh glyphicon-refresh-animate');\n\n        $('#create-child-name-input input, #create-child-cancel-button button, #create-child-expand-button')\n            .prop('disabled', false);\n    };\n\n    var getError = function(e) {\n        if (e) {\n            if (e.details) {\n                if (e.details['obj.name']) {\n                    return \"Name is invalid. Must be between 1 and 64 letters and numbers.\";\n                }\n            }\n            if (e.error)\n                return e.error;\n        }\n\n        return \"An error occurred\";\n    };\n\n    $.ajax({\n        type: \"PUT\",\n        url: jsRoutes.controllers.StreamApiController.apiCreateStream().url,\n        contentType: 'application/json',\n        data: JSON.stringify({\n          name: name,\n          uri: stream.uri() + \"/\" + name\n        }),\n        error: function(e) {\n            $('.create-child .error')\n                .removeClass('hidden')\n                .text(getError(e.responseJSON));\n\n            onComplete();\n        }\n    }).then(function(result) {\n        model.addChild(models.StreamModel.fromJson(result));\n        onComplete();\n        hideChildForm();\n    });\n};\n\n/**\n*/\nvar addFavorite = function(model, targetStreamId, childId) {\n    disableFavoriteButton();\n    $.ajax({\n        type: \"PUT\",\n        url: jsRoutes.controllers.StreamApiController.apiCreateChild(targetStreamId, childId).url,\n        error: function(error) {\n            model.favorite(FavoriteStatus.Unknown);\n        }\n    }).then(function(result) {\n        model.favorite(FavoriteStatus.Yes);\n    });\n};\n\nvar removeFavorite = function(model, targetStreamId, childId) {\n    disableFavoriteButton();\n    $.ajax({\n        type: \"DELETE\",\n        url: jsRoutes.controllers.StreamApiController.apiDeleteChild(targetStreamId, childId).url,\n        error: function(error) {\n            model.favorite(FavoriteStatus.Unknown);\n        }\n    }).then(function(result) {\n        model.favorite(FavoriteStatus.No);\n    });\n};\n\nvar updateSearchResultsForQuery = function(model, query) {\n    $('.list-loading').removeClass('hidden');\n    $('.no-results').addClass('hidden');\n    $.ajax({\n        type: \"GET\",\n        url: jsRoutes.controllers.StreamApiController.apiGetChildren(model.stream().id()).url,\n        data: {\n            query: query\n        },\n        headers: {\n            accept: \"application/json\"\n        },\n        error: function(e) {\n            $('.list-loading').addClass('hidden');\n        }\n    }).done(function(result) {\n        $('.list-loading').addClass('hidden');\n        model.query(query);\n        model.children().children((result || []).map(models.StreamModel.fromJson));\n    });\n};\n\nvar updateSearchResults = function(model) {\n    var query = $('#stream-search-form input').val();\n    return updateSearchResultsForQuery(model, query);\n};\n\n/**\n*/\nvar updateStreamTags = function(model, tags) {\n    $.ajax({\n        type: \"POST\",\n        url: jsRoutes.controllers.StreamApiController.setTags(model.stream().id()).url,\n        contentType: 'application/json',\n        data: JSON.stringify(tags.map(function(x) { return { \"tag\": x.value() }; })),\n        headers: {\n            accept: \"application/json\"\n        },\n        error: function(e) {\n\n        }\n    }).done(function(result) {\n        model.stream().tags(\n            result.map(function(tag) {\n                return new models.TagModel(tag.tag);\n            }));\n    });\n};\n\n/**\n    Convert a list of tags to a editable string representation.\n*/\nvar tagsToString = function(tags) {\n    return Array.prototype.map.call(tags, function(x) { return x.value(); })\n        .join(', ');\n};\n\n/**\n    Convert a string to a list of tags.\n*/\nvar stringToTags = function(tags) {\n    return (tags.match(/([a-zA-Z0-9_\\-$])+/ig) || []).map(function(tag) {\n        return new models.TagModel(tag.trim());\n    });\n};\n\n/**\n    Edit the stream's tags.\n*/\nvar editTags = function(model) {\n    $('#save-tags-button').removeClass('hidden');\n    $('#edit-tags-button').addClass('hidden');\n    $('.tag-list').addClass('hidden');\n\n    $('#tag-input')\n        .removeClass('hidden');\n\n    $('#tag-input input')\n        .val(tagsToString(model.stream().tags()));\n};\n\n/**\n    Save the edited tags.\n*/\nvar saveTags = function(model) {\n    $('#save-tags-button').addClass('hidden');\n    $('#edit-tags-button').removeClass('hidden');\n    $('#tag-input').addClass('hidden');\n    $('.tag-list').removeClass('hidden');\n\n    var tags = stringToTags($('#tag-input input').val());\n    updateStreamTags(model, tags);\n};\n\n/**\n*/\n$(function(){\n    var model = new AppViewModel(\n        application_model.initialUser(),\n        initialStream());\n\n    var updateStatus = function(color) {\n        var stream = model.stream();\n        if (!stream)\n            return;\n\n        $.ajax({\n            type: \"POST\",\n            url: jsRoutes.controllers.StreamApiController.apiSetStreamStatus(stream.id()).url,\n            contentType: 'application/json',\n            data: JSON.stringify({\n                color: color\n            })\n        });\n\n        model.stream().updated(new Date());\n        model.setColor(color);\n    };\n\n    var statusPicker = (function() {\n        var currentColor = models.DEFAULT_COLOR;\n        var pickedColor = models.DEFAULT_COLOR;\n        model.manager.subscribe(model.stream().uri(), {\n            'StatusUpdated': function(msg) {\n                if (msg.from === model.stream().uri()) {\n                    currentColor = msg.status.color;\n                }\n            }\n        });\n\n        var statusPicker = $('.status-picker')\n            .spectrum({\n                showInput: true,\n                showPalette: true,\n                showSelectionPalette: true,\n                preferredFormat: \"hex\",\n                localStorageKey: \"blotre.stream.statusPicker\"\n            })\n            .on('show.spectrum', function(e, color) {\n                pickedColor = currentColor = color + '';\n            })\n            .on('move.spectrum change.spectrum', function(e, color) {\n                model.setColor(color + '');\n            })\n            .on('hide.spectrum', function(e, color) {\n                pickedColor = color + '';\n                model.setColor(currentColor);\n            });\n\n        $('.sp-choose')\n            .on('click', function() {\n                updateStatus(pickedColor + '');\n            });\n\n        return statusPicker;\n    }());\n\n    $('.status-picker-form')\n        .on('submit', function(e) {\n            e.preventDefault();\n            var color = $(this).children('.status-picker').val();\n            updateStatus(color);\n        });\n\n    // Create child form\n    $('#create-child-expand-button')\n        .on('click', function(e) {\n            var hidden = $('#create-child-name-input').hasClass('hidden');\n            var target = $('#create-child-name-input, #create-child-cancel-button');\n            if (hidden) {\n                target.removeClass('hidden');\n            } else {\n                createChildStream(model, model.stream(), model.user(), $('#create-child-name-input input').val().trim());\n            }\n        });\n\n    $('#create-child-name-input').keypress(function(e) {\n        if (e.keyCode === 13) {\n            createChildStream(model, model.stream(), model.user(), $('#create-child-name-input input').val().trim());\n        }\n    });\n\n    $('#create-child-cancel-button button')\n        .on('click', hideChildForm);\n\n    // Tag editor\n    $('#edit-tags-button').on('click', function(e) {\n        editTags(model);\n    });\n\n    $('#save-tags-button').on('click', function(e) {\n        saveTags(model);\n    });\n\n    $('#tag-input input').keypress(function(e) {\n        if (e.keyCode === 13 /*enter*/) {\n            saveTags(model);\n        }\n    });\n\n    // Child Search\n    $('#stream-search-form button').on('click', function(e) {\n        e.preventDefault();\n        updateSearchResults(model);\n    });\n\n    $('#stream-search-form input').keypress(function(e) {\n        if (e.keyCode === 13 /*enter*/) {\n            updateSearchResults(model);\n            e.preventDefault();\n        }\n    });\n\n    // Children\n    var query = shared.getQueryString().query;\n    updateSearchResultsForQuery(model, (query || ''));\n\n    model.manager.subscribeCollection(model.stream().uri(), {\n        'StatusUpdated': function(msg) {\n            var existingChild = model.removeChild(msg.from);\n            if (existingChild.length) {\n                existingChild[0].status(models.StatusModel.fromJson(msg.status));\n                model.addChild(existingChild[0]);\n            }\n        },\n        'ChildAdded': function(msg) {\n            model.addChild(models.StreamModel.fromJson(msg.child));\n        },\n        'ChildRemoved': function(msg) {\n            model.removeChild(msg.child);\n        }\n    });\n\n    model.color.subscribe(updateFavicon);\n\n    model.children().children.subscribe(function(results) {\n        if (results.length)\n            $('.no-results').addClass('hidden');\n        else\n            $('.no-results').removeClass('hidden');\n    });\n\n    // Favorite Button\n    disableFavoriteButton();\n\n    model.favorite.subscribe(function(status) {\n        switch (status) {\n        case FavoriteStatus.Yes:\n            return enableFavoriteButton(true);\n        case FavoriteStatus.No:\n            return enableFavoriteButton(false);\n        default:\n            return disableFavoriteButton();\n        }\n    });\n\n    model.checkFavorite();\n\n\n    $('button.stream-favorite').click(function(e) {\n        switch (model.favorite()) {\n        case FavoriteStatus.Yes:\n            return removeFavorite(model, model.user().rootStream(), model.stream().id());\n        case FavoriteStatus.No:\n            return addFavorite(model, model.user().rootStream(), model.stream().id());\n        }\n    });\n\n    model.manager.subscribe(model.stream().uri(), {\n        'StatusUpdated': function(msg) {\n            if (msg.from === model.stream().uri()) {\n                model.setColor(msg.status.color);\n                model.stream().updated(new Date(msg.status.created));\n                statusPicker.spectrum(\"set\", msg.status.color);\n            }\n        },\n        'ParentAdded': function(msg) {\n            if (msg.from === model.stream().uri() && msg.parent.uri === model.user().userName())\n                model.favorite(FavoriteStatus.Yes);\n        },\n        'ParentRemoved': function(msg) {\n            if (msg.from === model.stream().uri() && msg.parent === model.user().userName())\n                model.favorite(FavoriteStatus.No);\n        },\n    });\n\n    ko.applyBindings(model);\n});\n\n});"],"sourceRoot":"/source/"}